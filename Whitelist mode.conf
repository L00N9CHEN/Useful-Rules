# 通用配置
[General]
# DNS劫持。有些设备或软件总是使用硬编码的DNS服务器，例如Netflix通过Google DNS(8.8.8.8或8.8.4.4)发送请求，您可以使用此选项来劫持查询。
hijack-dns = 8.8.8.8:53,1.1.1.1:53
# 备用DNS。当覆写的DNS解析失败后回退备用DNS，如需指定多个DNS，可用逗号分隔。system表示回退到系统DNS。
fallback-dns-server = 1.1.1.1,223.5.5.5
# 包含配置。如“include=a.conf”表示当前配置包含另一个配置a.conf的内容，当前配置的优先级高于a.conf。该选项是对配置建立包含关系，以满足同时使用多个配置的需求。
include =
# 旁路系统。如果禁用此选项，可能会导致一些系统问题，如推送通知延迟。
bypass-system = true
# 跳过代理。此选项强制这些域名或IP的连接范围由Shadowrocket TUN接口来处理，而不是Shadowrocket代理服务器。此选项用于解决一些应用程序的一些兼容性问题。
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com,*.ccb.com,*.abchina.com.cn,*.psbc.com,www.baidu.com
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 239.255.255.250/32
dns-server = https://dns.google/dns-query,https://cloudflare-dns.com/dns-query,https://dns.alidns.com/dns-query
# 启用IPv6支持。false表示不启用，true表示启用。
ipv6 = true
# 首选IPv6。优先向IPv6的DNS服务器查询AAAA记录，优先使用AAAA记录。false表示不启用。
prefer-ipv6 = false
dns-fallback-system = false
# 直连的域名类规则使用系统dns进行查询。false表示不启用。
dns-direct-system = false
# ping数据包自动回复。
icmp-auto-reply = true
# 不开启时，REJECT策略默认只有在配置模式下生效。开启后，可以令该策略在其他全局路由模式下都生效。
always-reject-url-rewrite = false
# 私有IP应答。如果不启用该选项，域名解析返回私有IP，Shadowrocket会认为该域名被劫持而强制使用代理。
private-ip-answer = true
# 直连域名解析失败后使用代理。false表示不启用。
dns-direct-fallback-proxy = true

# 代理分组
[Proxy Group]
# 代理分组类型：
# select:手动选择节点。
# url-test:自动选择延迟最低节点。
# fallback:节点挂掉时自动切换其他可用节点。
# load-balance:不同规则的请求使用分组里的不同节点进行连接。
# random:随机使用分组里的不同节点进行连接。
# ----------


[Rule]
# 解锁 TikTok
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/TikTok.txt,PROXY
# RUle_SET,https://cdn.jsdelivr.net/gh/L00N9CHEN/Useful-Rules@release/TikTok.txt,PROXY

# iCloud 域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/icloud.txt,DIRECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/icloud.txt,DIRECT

# Apple 在中国大陆可直连的域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/apple.txt,DIRECT
# RUle_SET,https://cdn.jsdelivr.net/gh/L00N9CHEN/Useful-Rules@release/apple.txt,DIRECT

# 私有网络专用域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/private.txt,DIRECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/private.txt,DIRECT

# 广告域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/reject.txt,REJECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/reject.txt,REJECT

# 代理域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/proxy.txt,PROXY
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/proxy.txt,PROXY

# 直连域名列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/direct.txt,DIRECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/direct.txt,DIRECT

# 中国大陆 IP 地址列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/cncidr.txt,DIRECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/cncidr.txt,DIRECT

# 局域网及预留 IP 地址列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/lancidr.txt,DIRECT
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/lancidr.txt,DIRECT

# Telegram 使用的 IP 地址列表
RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/telegramcidr.txt,PROXY
# RULE_SET,https://raw.githubusercontent.com/L00N9CHEN/Useful-Rules/release/telegramcidr.txt,PROXY

# 表示CN地区的IP分流走直连，GEOIP数据库用来判断IP是否属于CN地区。默认使用Shadowrocket自带的GEOIP数据库，如果您想替换其他数据库，可在 设置 - GeoLite2数据库 里添加和修改。
GEOIP,CN,DIRECT

# 表示当其他所有规则都匹配不到时才使用FINAL规则的策略。
FINAL,PROXY

#URL 重写
[URL Rewrite]
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302
# 免拔卡解锁TikTok的重写，默认解锁地区为「美国」。需要换区时，请将下面一行的“US”修改成其他国家或地区的英文名缩写，如“TW、KR、JP”等。
(?<=_region=)CN(?=&) US 307
(?<=&mcc_mnc=)4 2 307
^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
(^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302

# HTTPS解密
[MITM]
hostname = *.tiktokv.com,*.byteoversea.com,*.tik-tokapi.com,*snssdk.com,*amemv.com,*instagram.com
# ----------
# Shadowrocket打开HTTPS解密方法：
# 1.点击「正在使用的配置」后面的ⓘ - HTTPS解密 - 证书 - 生成新的CA证书 - 安装证书。
# 2.手机设置 - 已下载描述文件 - 安装。
# 3.手机设置 - 通用 - 关于本机 - 证书信任设置 - 开启对应Shadowrocket证书信任。
# ----------